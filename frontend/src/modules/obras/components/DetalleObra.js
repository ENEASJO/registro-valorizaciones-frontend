import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { useState, useEffect } from 'react';
import { motion } from 'framer-motion';
import { X, Construction, Building2, MapPin, Calendar, DollarSign, User, Clock, TrendingUp, AlertCircle, CheckCircle, FileText, BarChart, Users, Edit, Calculator, Target, Briefcase, Phone, Mail, Award } from 'lucide-react';
import * as Tabs from '@radix-ui/react-tabs';
import { ESTADOS_OBRA, TIPOS_OBRA } from '../../../types/obra.types';
import { useObras, useProfesionales, useValorizaciones } from '../../../hooks/useObras';
import { useEntidadesContratistas } from '../../../hooks/useEmpresas';
const DetalleObra = ({ obraId, isOpen, onClose, onEditar }) => {
    const { obtenerObraPorId } = useObras();
    const { profesionales, cargarProfesionalesPorObra } = useProfesionales();
    const { valorizaciones, cargarValorizacionesPorObra } = useValorizaciones();
    const { entidades } = useEntidadesContratistas();
    const [tabActivo, setTabActivo] = useState('general');
    const [obra, setObra] = useState(null);
    const [loading, setLoading] = useState(false);
    // Cargar datos de la obra
    useEffect(() => {
        if (obraId && isOpen) {
            setLoading(true);
            const obraData = obtenerObraPorId(obraId);
            setObra(obraData);
            // Cargar datos relacionados
            cargarProfesionalesPorObra(obraId);
            cargarValorizacionesPorObra(obraId);
            setLoading(false);
        }
    }, [obraId, isOpen, obtenerObraPorId, cargarProfesionalesPorObra, cargarValorizacionesPorObra]);
    if (!isOpen || !obra)
        return null;
    // Obtener información de entidades
    const entidadEjecutora = entidades.find(e => e.id === obra.entidad_ejecutora_id);
    const entidadSupervisora = entidades.find(e => e.id === obra.entidad_supervisora_id);
    // Configuración de estado
    const getEstadoConfig = (estado) => {
        switch (estado) {
            case 'REGISTRADA':
                return { color: 'text-gray-700 bg-gray-100', icon: Clock };
            case 'EN_EJECUCION':
                return { color: 'text-blue-700 bg-blue-100', icon: Construction };
            case 'PARALIZADA':
                return { color: 'text-yellow-700 bg-yellow-100', icon: AlertCircle };
            case 'TERMINADA':
                return { color: 'text-green-700 bg-green-100', icon: CheckCircle };
            case 'LIQUIDADA':
                return { color: 'text-purple-700 bg-purple-100', icon: Calculator };
            case 'CANCELADA':
                return { color: 'text-red-700 bg-red-100', icon: AlertCircle };
            default:
                return { color: 'text-gray-700 bg-gray-100', icon: Clock };
        }
    };
    const estadoConfig = getEstadoConfig(obra.estado);
    const IconoEstado = estadoConfig.icon;
    // Calcular progreso estimado
    const diasTranscurridos = Math.floor((new Date().getTime() - new Date(obra.fecha_inicio).getTime()) / (1000 * 60 * 60 * 24));
    const progresoTiempo = Math.min((diasTranscurridos / obra.plazo_ejecucion_dias) * 100, 100);
    // Calcular progreso financiero (simulado)
    const montoEjecutadoSimulado = valorizaciones
        .filter(v => v.estado === 'APROBADA')
        .reduce((sum, v) => sum + v.monto_ejecutado, 0);
    const progresoFinanciero = (montoEjecutadoSimulado / obra.monto_ejecucion) * 100;
    // Formatear moneda
    const formatearMoneda = (monto) => {
        return `S/ ${monto.toLocaleString('es-PE', { minimumFractionDigits: 2 })}`;
    };
    // Calcular días restantes
    const diasRestantes = Math.max(0, obra.plazo_ejecucion_dias - diasTranscurridos);
    return (_jsx("div", { className: "fixed inset-0 z-50 overflow-y-auto", children: _jsxs("div", { className: "flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0", children: [_jsx("div", { className: "fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75", onClick: onClose }), _jsxs(motion.div, { initial: { opacity: 0, scale: 0.95 }, animate: { opacity: 1, scale: 1 }, exit: { opacity: 0, scale: 0.95 }, className: "inline-block w-full max-w-7xl px-6 py-4 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-lg", children: [_jsxs("div", { className: "flex items-start justify-between mb-6 pb-4 border-b border-gray-200", children: [_jsxs("div", { className: "flex-1 min-w-0", children: [_jsxs("div", { className: "flex items-center gap-3 mb-2", children: [_jsx(Construction, { className: "w-6 h-6 text-primary-600" }), _jsx("span", { className: "text-sm font-medium text-primary-600 bg-primary-50 px-3 py-1 rounded-full", children: obra.numero_contrato }), _jsxs("span", { className: `px-3 py-1 text-xs font-medium rounded-full flex items-center gap-1 ${estadoConfig.color}`, children: [_jsx(IconoEstado, { className: "w-3 h-3" }), ESTADOS_OBRA[obra.estado]] })] }), _jsx("h2", { className: "text-2xl font-bold text-gray-900 mb-1", children: obra.nombre }), obra.codigo_interno && (_jsxs("p", { className: "text-sm text-gray-600", children: ["C\u00F3digo Interno: ", obra.codigo_interno] }))] }), _jsxs("div", { className: "flex items-center gap-2 ml-4", children: [onEditar && (_jsxs("button", { onClick: () => onEditar(obra.id), className: "btn-secondary flex items-center gap-2", children: [_jsx(Edit, { className: "w-4 h-4" }), "Editar"] })), _jsx("button", { onClick: onClose, className: "p-2 text-gray-400 hover:text-gray-600 transition-colors", children: _jsx(X, { className: "w-5 h-5" }) })] })] }), loading ? (_jsx("div", { className: "flex justify-center py-12", children: _jsx("div", { className: "w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin" }) })) : (_jsxs(_Fragment, { children: [_jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8", children: [_jsxs("div", { className: "bg-primary-50 rounded-xl p-6", children: [_jsxs("div", { className: "flex items-center gap-3 mb-2", children: [_jsx(DollarSign, { className: "w-8 h-8 text-primary-600" }), _jsxs("div", { children: [_jsx("p", { className: "text-lg font-bold text-primary-900", children: formatearMoneda(obra.monto_total) }), _jsx("p", { className: "text-sm text-primary-700", children: "Inversi\u00F3n Total" })] })] }), _jsxs("div", { className: "text-xs text-primary-600 mt-2", children: ["Ejecuci\u00F3n: ", formatearMoneda(obra.monto_ejecucion), " | Supervisi\u00F3n: ", formatearMoneda(obra.monto_supervision)] })] }), _jsxs("div", { className: "bg-blue-50 rounded-xl p-6", children: [_jsxs("div", { className: "flex items-center gap-3 mb-2", children: [_jsx(Calendar, { className: "w-8 h-8 text-blue-600" }), _jsxs("div", { children: [_jsx("p", { className: "text-lg font-bold text-blue-900", children: obra.plazo_ejecucion_dias }), _jsx("p", { className: "text-sm text-blue-700", children: "D\u00EDas de Plazo" })] })] }), _jsxs("div", { className: "text-xs text-blue-600 mt-2", children: ["Inicio: ", new Date(obra.fecha_inicio).toLocaleDateString('es-PE')] })] }), _jsxs("div", { className: "bg-green-50 rounded-xl p-6", children: [_jsxs("div", { className: "flex items-center gap-3 mb-2", children: [_jsx(TrendingUp, { className: "w-8 h-8 text-green-600" }), _jsxs("div", { children: [_jsxs("p", { className: "text-lg font-bold text-green-900", children: [progresoTiempo.toFixed(1), "%"] }), _jsx("p", { className: "text-sm text-green-700", children: "Progreso Tiempo" })] })] }), _jsxs("div", { className: "text-xs text-green-600 mt-2", children: [diasRestantes, " d\u00EDas restantes"] })] }), _jsxs("div", { className: "bg-purple-50 rounded-xl p-6", children: [_jsxs("div", { className: "flex items-center gap-3 mb-2", children: [_jsx(BarChart, { className: "w-8 h-8 text-purple-600" }), _jsxs("div", { children: [_jsx("p", { className: "text-lg font-bold text-purple-900", children: obra.numero_valorizaciones }), _jsx("p", { className: "text-sm text-purple-700", children: "Valorizaciones" })] })] }), _jsxs("div", { className: "text-xs text-purple-600 mt-2", children: [valorizaciones.filter(v => v.estado === 'APROBADA').length, " aprobadas"] })] })] }), _jsxs("div", { className: "bg-gray-50 rounded-xl p-6 mb-8", children: [_jsxs("div", { className: "flex justify-between items-center mb-4", children: [_jsx("h3", { className: "text-lg font-semibold text-gray-900", children: "Avance General de la Obra" }), _jsxs("div", { className: "text-right", children: [_jsxs("span", { className: "text-2xl font-bold text-gray-900", children: [progresoFinanciero.toFixed(1), "%"] }), _jsx("p", { className: "text-sm text-gray-600", children: "Avance Financiero" })] })] }), _jsxs("div", { className: "space-y-3", children: [_jsxs("div", { children: [_jsxs("div", { className: "flex justify-between items-center mb-1", children: [_jsx("span", { className: "text-sm font-medium text-gray-700", children: "Progreso Financiero" }), _jsx("span", { className: "text-sm text-gray-900", children: formatearMoneda(montoEjecutadoSimulado) })] }), _jsx("div", { className: "w-full bg-gray-200 rounded-full h-3", children: _jsx("div", { className: "bg-green-500 h-3 rounded-full transition-all duration-300", style: { width: `${Math.min(progresoFinanciero, 100)}%` } }) })] }), _jsxs("div", { children: [_jsxs("div", { className: "flex justify-between items-center mb-1", children: [_jsx("span", { className: "text-sm font-medium text-gray-700", children: "Progreso de Tiempo" }), _jsxs("span", { className: "text-sm text-gray-900", children: [diasTranscurridos, " / ", obra.plazo_ejecucion_dias, " d\u00EDas"] })] }), _jsx("div", { className: "w-full bg-gray-200 rounded-full h-3", children: _jsx("div", { className: `h-3 rounded-full transition-all duration-300 ${progresoTiempo > progresoFinanciero ? 'bg-yellow-500' : 'bg-blue-500'}`, style: { width: `${Math.min(progresoTiempo, 100)}%` } }) })] })] }), Math.abs(progresoTiempo - progresoFinanciero) > 10 && (_jsx("div", { className: "mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg", children: _jsxs("div", { className: "flex items-center gap-2", children: [_jsx(AlertCircle, { className: "w-4 h-4 text-yellow-600" }), _jsx("span", { className: "text-sm text-yellow-800", children: progresoTiempo > progresoFinanciero ?
                                                            'El avance financiero está rezagado respecto al cronograma' :
                                                            'El avance financiero está adelantado respecto al cronograma' })] }) }))] }), _jsxs(Tabs.Root, { value: tabActivo, onValueChange: setTabActivo, children: [_jsxs(Tabs.List, { className: "flex space-x-1 bg-gray-100 p-1 rounded-lg mb-6", children: [_jsxs(Tabs.Trigger, { value: "general", className: "flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-gray-900 text-gray-600 hover:text-gray-900 flex items-center gap-2", children: [_jsx(FileText, { className: "w-4 h-4" }), "Informaci\u00F3n General"] }), _jsxs(Tabs.Trigger, { value: "entidades", className: "flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-gray-900 text-gray-600 hover:text-gray-900 flex items-center gap-2", children: [_jsx(Building2, { className: "w-4 h-4" }), "Entidades"] }), _jsxs(Tabs.Trigger, { value: "plantel", className: "flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-gray-900 text-gray-600 hover:text-gray-900 flex items-center gap-2", children: [_jsx(Users, { className: "w-4 h-4" }), "Plantel (", profesionales.length, ")"] }), _jsxs(Tabs.Trigger, { value: "valorizaciones", className: "flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-gray-900 text-gray-600 hover:text-gray-900 flex items-center gap-2", children: [_jsx(BarChart, { className: "w-4 h-4" }), "Valorizaciones (", valorizaciones.length, ")"] })] }), _jsxs(Tabs.Content, { value: "general", className: "space-y-6", children: [_jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-6", children: [_jsxs("div", { className: "space-y-6", children: [_jsxs("div", { children: [_jsx("h3", { className: "text-lg font-semibold text-gray-900 mb-4", children: "Detalles de la Obra" }), _jsxs("div", { className: "space-y-4", children: [_jsxs("div", { className: "flex items-start gap-3", children: [_jsx(Target, { className: "w-5 h-5 text-gray-400 mt-0.5" }), _jsxs("div", { children: [_jsx("p", { className: "font-medium text-gray-900", children: "Tipo de Obra" }), _jsx("p", { className: "text-gray-600", children: obra.tipo_obra ? TIPOS_OBRA[obra.tipo_obra] : 'No especificado' })] })] }), _jsxs("div", { className: "flex items-start gap-3", children: [_jsx(Briefcase, { className: "w-5 h-5 text-gray-400 mt-0.5" }), _jsxs("div", { children: [_jsx("p", { className: "font-medium text-gray-900", children: "Modalidad de Ejecuci\u00F3n" }), _jsx("p", { className: "text-gray-600", children: obra.modalidad_ejecucion || 'No especificado' })] })] }), _jsxs("div", { className: "flex items-start gap-3", children: [_jsx(Calculator, { className: "w-5 h-5 text-gray-400 mt-0.5" }), _jsxs("div", { children: [_jsx("p", { className: "font-medium text-gray-900", children: "Sistema de Contrataci\u00F3n" }), _jsx("p", { className: "text-gray-600", children: obra.sistema_contratacion || 'No especificado' })] })] })] })] }), _jsxs("div", { children: [_jsx("h4", { className: "text-lg font-semibold text-gray-900 mb-4", children: "Ubicaci\u00F3n" }), _jsxs("div", { className: "space-y-3", children: [obra.ubicacion && (_jsxs("div", { className: "flex items-start gap-3", children: [_jsx(MapPin, { className: "w-5 h-5 text-gray-400 mt-0.5" }), _jsxs("div", { children: [_jsx("p", { className: "font-medium text-gray-900", children: "Ubicaci\u00F3n Espec\u00EDfica" }), _jsx("p", { className: "text-gray-600", children: obra.ubicacion })] })] })), _jsxs("div", { className: "grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm", children: [_jsxs("div", { children: [_jsx("p", { className: "font-medium text-gray-900", children: "Departamento" }), _jsx("p", { className: "text-gray-600", children: obra.departamento || 'No especificado' })] }), _jsxs("div", { children: [_jsx("p", { className: "font-medium text-gray-900", children: "Provincia" }), _jsx("p", { className: "text-gray-600", children: obra.provincia || 'No especificado' })] }), _jsxs("div", { children: [_jsx("p", { className: "font-medium text-gray-900", children: "Distrito" }), _jsx("p", { className: "text-gray-600", children: obra.distrito || 'No especificado' })] })] })] })] })] }), _jsxs("div", { className: "space-y-6", children: [_jsxs("div", { children: [_jsx("h4", { className: "text-lg font-semibold text-gray-900 mb-4", children: "Cronograma" }), _jsxs("div", { className: "space-y-3", children: [_jsxs("div", { className: "flex justify-between items-center p-3 bg-gray-50 rounded-lg", children: [_jsx("span", { className: "font-medium text-gray-900", children: "Fecha de Inicio" }), _jsx("span", { className: "text-gray-700", children: new Date(obra.fecha_inicio).toLocaleDateString('es-PE') })] }), _jsxs("div", { className: "flex justify-between items-center p-3 bg-gray-50 rounded-lg", children: [_jsx("span", { className: "font-medium text-gray-900", children: "Fecha de Fin Prevista" }), _jsx("span", { className: "text-gray-700", children: new Date(obra.fecha_fin_prevista).toLocaleDateString('es-PE') })] }), _jsxs("div", { className: "flex justify-between items-center p-3 bg-gray-50 rounded-lg", children: [_jsx("span", { className: "font-medium text-gray-900", children: "Plazo Total" }), _jsxs("span", { className: "text-gray-700", children: [obra.plazo_ejecucion_dias, " d\u00EDas"] })] }), _jsxs("div", { className: "flex justify-between items-center p-3 bg-gray-50 rounded-lg", children: [_jsx("span", { className: "font-medium text-gray-900", children: "D\u00EDas Transcurridos" }), _jsxs("span", { className: "text-gray-700", children: [diasTranscurridos, " d\u00EDas"] })] }), _jsxs("div", { className: "flex justify-between items-center p-3 bg-gray-50 rounded-lg", children: [_jsx("span", { className: "font-medium text-gray-900", children: "D\u00EDas Restantes" }), _jsxs("span", { className: `font-medium ${diasRestantes < 30 ? 'text-red-600' :
                                                                                                diasRestantes < 90 ? 'text-yellow-600' : 'text-green-600'}`, children: [diasRestantes, " d\u00EDas"] })] }), obra.fecha_termino && (_jsxs("div", { className: "flex justify-between items-center p-3 bg-purple-50 rounded-lg border-2 border-purple-200", children: [_jsx("span", { className: "font-medium text-purple-900", children: "Fecha de T\u00E9rmino" }), _jsx("span", { className: "text-purple-700 font-medium", children: new Date(obra.fecha_termino).toLocaleDateString('es-PE') })] }))] })] }), _jsxs("div", { children: [_jsx("h4", { className: "text-lg font-semibold text-gray-900 mb-4", children: "Presupuesto" }), _jsxs("div", { className: "space-y-3", children: [_jsxs("div", { className: "flex justify-between items-center p-3 bg-green-50 rounded-lg", children: [_jsx("span", { className: "font-medium text-gray-900", children: "Monto de Ejecuci\u00F3n" }), _jsx("span", { className: "font-bold text-green-700", children: formatearMoneda(obra.monto_ejecucion) })] }), _jsxs("div", { className: "flex justify-between items-center p-3 bg-blue-50 rounded-lg", children: [_jsx("span", { className: "font-medium text-gray-900", children: "Monto de Supervisi\u00F3n" }), _jsx("span", { className: "font-bold text-blue-700", children: formatearMoneda(obra.monto_supervision) })] }), _jsxs("div", { className: "flex justify-between items-center p-3 bg-primary-50 rounded-lg border-2 border-primary-200", children: [_jsx("span", { className: "font-bold text-primary-900", children: "Monto Total" }), _jsx("span", { className: "font-bold text-primary-700 text-lg", children: formatearMoneda(obra.monto_total) })] })] })] })] })] }), obra.descripcion && (_jsxs("div", { children: [_jsx("h4", { className: "text-lg font-semibold text-gray-900 mb-3", children: "Descripci\u00F3n" }), _jsx("p", { className: "text-gray-700 bg-gray-50 p-4 rounded-lg", children: obra.descripcion })] })), obra.observaciones && (_jsxs("div", { children: [_jsx("h4", { className: "text-lg font-semibold text-gray-900 mb-3", children: "Observaciones" }), _jsx("p", { className: "text-gray-700 bg-yellow-50 p-4 rounded-lg border border-yellow-200", children: obra.observaciones })] }))] }), _jsx(Tabs.Content, { value: "entidades", className: "space-y-6", children: _jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-6", children: [_jsxs("div", { className: "bg-blue-50 rounded-xl p-6 border-2 border-blue-200", children: [_jsxs("div", { className: "flex items-center gap-3 mb-4", children: [_jsx("div", { className: "w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center", children: _jsx(Construction, { className: "w-5 h-5 text-blue-600" }) }), _jsxs("div", { children: [_jsx("h3", { className: "text-lg font-semibold text-blue-900", children: "Entidad Ejecutora" }), _jsx("p", { className: "text-blue-700 text-sm", children: "Responsable de la ejecuci\u00F3n" })] })] }), entidadEjecutora ? (_jsxs("div", { className: "space-y-3", children: [_jsxs("div", { children: [_jsx("p", { className: "font-semibold text-blue-900", children: entidadEjecutora.nombre_completo }), _jsx("p", { className: "text-blue-700 text-sm", children: entidadEjecutora.tipo_entidad })] }), entidadEjecutora.ruc_principal && (_jsx("div", { children: _jsxs("p", { className: "text-sm text-blue-700", children: [_jsx("span", { className: "font-medium", children: "RUC:" }), " ", entidadEjecutora.ruc_principal] }) })), entidadEjecutora.datos_empresa && (_jsxs("div", { className: "space-y-2 text-sm", children: [entidadEjecutora.datos_empresa.email && (_jsxs("div", { className: "flex items-center gap-2", children: [_jsx(Mail, { className: "w-4 h-4 text-blue-600" }), _jsx("span", { children: entidadEjecutora.datos_empresa.email })] })), entidadEjecutora.datos_empresa.telefono && (_jsxs("div", { className: "flex items-center gap-2", children: [_jsx(Phone, { className: "w-4 h-4 text-blue-600" }), _jsx("span", { children: entidadEjecutora.datos_empresa.telefono })] })), entidadEjecutora.datos_empresa.categoria_contratista && (_jsxs("div", { className: "flex items-center gap-2", children: [_jsx(Award, { className: "w-4 h-4 text-blue-600" }), _jsxs("span", { children: ["Categor\u00EDa: ", entidadEjecutora.datos_empresa.categoria_contratista] })] }))] })), entidadEjecutora.datos_consorcio && (_jsxs("div", { className: "text-sm", children: [_jsxs("p", { className: "text-blue-700 mb-2", children: [_jsx("span", { className: "font-medium", children: "Empresa L\u00EDder:" }), " ", entidadEjecutora.datos_consorcio.empresa_lider_nombre] }), entidadEjecutora.empresas_participantes && (_jsxs("div", { children: [_jsx("p", { className: "font-medium text-blue-700 mb-1", children: "Empresas Participantes:" }), _jsx("ul", { className: "space-y-1", children: entidadEjecutora.empresas_participantes.map((emp, index) => (_jsxs("li", { className: "text-blue-600 text-xs", children: ["\u2022 ", emp.empresa_nombre, " (", emp.porcentaje_participacion, "%)"] }, index))) })] }))] }))] })) : (_jsx("p", { className: "text-blue-600", children: "Informaci\u00F3n no disponible" }))] }), _jsxs("div", { className: "bg-purple-50 rounded-xl p-6 border-2 border-purple-200", children: [_jsxs("div", { className: "flex items-center gap-3 mb-4", children: [_jsx("div", { className: "w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center", children: _jsx(CheckCircle, { className: "w-5 h-5 text-purple-600" }) }), _jsxs("div", { children: [_jsx("h3", { className: "text-lg font-semibold text-purple-900", children: "Entidad Supervisora" }), _jsx("p", { className: "text-purple-700 text-sm", children: "Responsable de la supervisi\u00F3n" })] })] }), entidadSupervisora ? (_jsxs("div", { className: "space-y-3", children: [_jsxs("div", { children: [_jsx("p", { className: "font-semibold text-purple-900", children: entidadSupervisora.nombre_completo }), _jsx("p", { className: "text-purple-700 text-sm", children: entidadSupervisora.tipo_entidad })] }), entidadSupervisora.ruc_principal && (_jsx("div", { children: _jsxs("p", { className: "text-sm text-purple-700", children: [_jsx("span", { className: "font-medium", children: "RUC:" }), " ", entidadSupervisora.ruc_principal] }) })), entidadSupervisora.datos_empresa && (_jsxs("div", { className: "space-y-2 text-sm", children: [entidadSupervisora.datos_empresa.email && (_jsxs("div", { className: "flex items-center gap-2", children: [_jsx(Mail, { className: "w-4 h-4 text-purple-600" }), _jsx("span", { children: entidadSupervisora.datos_empresa.email })] })), entidadSupervisora.datos_empresa.telefono && (_jsxs("div", { className: "flex items-center gap-2", children: [_jsx(Phone, { className: "w-4 h-4 text-purple-600" }), _jsx("span", { children: entidadSupervisora.datos_empresa.telefono })] })), entidadSupervisora.datos_empresa.categoria_contratista && (_jsxs("div", { className: "flex items-center gap-2", children: [_jsx(Award, { className: "w-4 h-4 text-purple-600" }), _jsxs("span", { children: ["Categor\u00EDa: ", entidadSupervisora.datos_empresa.categoria_contratista] })] }))] })), entidadSupervisora.datos_consorcio && (_jsxs("div", { className: "text-sm", children: [_jsxs("p", { className: "text-purple-700 mb-2", children: [_jsx("span", { className: "font-medium", children: "Empresa L\u00EDder:" }), " ", entidadSupervisora.datos_consorcio.empresa_lider_nombre] }), entidadSupervisora.empresas_participantes && (_jsxs("div", { children: [_jsx("p", { className: "font-medium text-purple-700 mb-1", children: "Empresas Participantes:" }), _jsx("ul", { className: "space-y-1", children: entidadSupervisora.empresas_participantes.map((emp, index) => (_jsxs("li", { className: "text-purple-600 text-xs", children: ["\u2022 ", emp.empresa_nombre, " (", emp.porcentaje_participacion, "%)"] }, index))) })] }))] }))] })) : (_jsx("p", { className: "text-purple-600", children: "Informaci\u00F3n no disponible" }))] })] }) }), _jsx(Tabs.Content, { value: "plantel", className: "space-y-6", children: profesionales.length > 0 ? (_jsx("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-6", children: profesionales.map((profesional) => (_jsxs("div", { className: "bg-white border border-gray-200 rounded-xl p-6 shadow-sm", children: [_jsxs("div", { className: "flex items-start justify-between mb-4", children: [_jsxs("div", { className: "flex-1", children: [_jsx("h4", { className: "text-lg font-semibold text-gray-900", children: profesional.nombre_completo }), _jsx("p", { className: "text-sm text-gray-600", children: profesional.cargo || 'Cargo no especificado' })] }), _jsxs("div", { className: "text-right", children: [_jsxs("span", { className: "text-lg font-bold text-primary-600", children: [profesional.porcentaje_participacion, "%"] }), _jsx("p", { className: "text-xs text-gray-500", children: "Participaci\u00F3n" })] })] }), _jsxs("div", { className: "space-y-3 text-sm", children: [profesional.numero_colegiatura && (_jsxs("div", { className: "flex items-center gap-2", children: [_jsx(Award, { className: "w-4 h-4 text-gray-400" }), _jsxs("span", { className: "text-gray-600", children: ["Colegiatura: ", profesional.numero_colegiatura] })] })), profesional.dni && (_jsxs("div", { className: "flex items-center gap-2", children: [_jsx(User, { className: "w-4 h-4 text-gray-400" }), _jsxs("span", { className: "text-gray-600", children: ["DNI: ", profesional.dni] })] })), profesional.telefono && (_jsxs("div", { className: "flex items-center gap-2", children: [_jsx(Phone, { className: "w-4 h-4 text-gray-400" }), _jsx("span", { className: "text-gray-600", children: profesional.telefono })] })), profesional.email && (_jsxs("div", { className: "flex items-center gap-2", children: [_jsx(Mail, { className: "w-4 h-4 text-gray-400" }), _jsx("span", { className: "text-gray-600", children: profesional.email })] })), profesional.responsabilidades && profesional.responsabilidades.length > 0 && (_jsxs("div", { children: [_jsx("p", { className: "font-medium text-gray-900 mb-1", children: "Responsabilidades:" }), _jsx("ul", { className: "list-disc list-inside space-y-1 text-gray-600", children: profesional.responsabilidades.map((resp, index) => (_jsx("li", { children: resp }, index))) })] }))] }), _jsx("div", { className: "mt-4 pt-3 border-t border-gray-200", children: _jsxs("div", { className: "flex justify-between text-xs text-gray-500", children: [_jsxs("span", { children: ["Desde: ", new Date(profesional.fecha_inicio_participacion).toLocaleDateString('es-PE')] }), _jsx("span", { className: `px-2 py-1 rounded-full ${profesional.estado === 'ACTIVO' ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-700'}`, children: profesional.estado })] }) })] }, profesional.id))) })) : (_jsxs("div", { className: "text-center py-12", children: [_jsx(Users, { className: "w-16 h-16 text-gray-300 mx-auto mb-4" }), _jsx("h3", { className: "text-lg font-medium text-gray-900 mb-2", children: "Sin plantel profesional asignado" }), _jsx("p", { className: "text-gray-600", children: "No hay profesionales registrados para esta obra" })] })) }), _jsx(Tabs.Content, { value: "valorizaciones", className: "space-y-6", children: valorizaciones.length > 0 ? (_jsx("div", { className: "space-y-4", children: valorizaciones.map((valorizacion) => (_jsxs("div", { className: "bg-white border border-gray-200 rounded-xl p-6 shadow-sm", children: [_jsxs("div", { className: "flex items-start justify-between mb-4", children: [_jsxs("div", { children: [_jsxs("h4", { className: "text-lg font-semibold text-gray-900", children: ["Valorizaci\u00F3n N\u00B0 ", valorizacion.numero_valorizacion] }), _jsxs("p", { className: "text-sm text-gray-600", children: ["Per\u00EDodo: ", new Date(valorizacion.periodo_inicio).toLocaleDateString('es-PE'), " - ", ' ', new Date(valorizacion.periodo_fin).toLocaleDateString('es-PE')] })] }), _jsx("span", { className: `px-3 py-1 text-xs font-medium rounded-full ${valorizacion.estado === 'APROBADA' ? 'bg-green-100 text-green-800' :
                                                                        valorizacion.estado === 'PAGADA' ? 'bg-blue-100 text-blue-800' :
                                                                            valorizacion.estado === 'EN_PROCESO' ? 'bg-yellow-100 text-yellow-800' :
                                                                                'bg-gray-100 text-gray-800'}`, children: valorizacion.estado })] }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-4 gap-4 mb-4", children: [_jsxs("div", { className: "text-center p-3 bg-gray-50 rounded-lg", children: [_jsx("p", { className: "text-sm text-gray-600", children: "Monto Ejecutado" }), _jsx("p", { className: "font-bold text-gray-900", children: formatearMoneda(valorizacion.monto_ejecutado) })] }), _jsxs("div", { className: "text-center p-3 bg-gray-50 rounded-lg", children: [_jsx("p", { className: "text-sm text-gray-600", children: "% Avance" }), _jsxs("p", { className: "font-bold text-gray-900", children: [valorizacion.porcentaje_avance, "%"] })] }), _jsxs("div", { className: "text-center p-3 bg-gray-50 rounded-lg", children: [_jsx("p", { className: "text-sm text-gray-600", children: "Monto Acumulado" }), _jsx("p", { className: "font-bold text-gray-900", children: formatearMoneda(valorizacion.monto_acumulado) })] }), _jsxs("div", { className: "text-center p-3 bg-gray-50 rounded-lg", children: [_jsx("p", { className: "text-sm text-gray-600", children: "% Acumulado" }), _jsxs("p", { className: "font-bold text-gray-900", children: [valorizacion.porcentaje_acumulado, "%"] })] })] }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-4 text-sm", children: [_jsxs("div", { children: [_jsx("p", { className: "text-gray-600", children: "Fecha Programada:" }), _jsx("p", { className: "font-medium text-gray-900", children: new Date(valorizacion.fecha_programada).toLocaleDateString('es-PE') })] }), valorizacion.fecha_presentacion && (_jsxs("div", { children: [_jsx("p", { className: "text-gray-600", children: "Fecha Presentaci\u00F3n:" }), _jsx("p", { className: "font-medium text-gray-900", children: new Date(valorizacion.fecha_presentacion).toLocaleDateString('es-PE') })] })), valorizacion.fecha_aprobacion && (_jsxs("div", { children: [_jsx("p", { className: "text-gray-600", children: "Fecha Aprobaci\u00F3n:" }), _jsx("p", { className: "font-medium text-gray-900", children: new Date(valorizacion.fecha_aprobacion).toLocaleDateString('es-PE') })] }))] })] }, valorizacion.id))) })) : (_jsxs("div", { className: "text-center py-12", children: [_jsx(BarChart, { className: "w-16 h-16 text-gray-300 mx-auto mb-4" }), _jsx("h3", { className: "text-lg font-medium text-gray-900 mb-2", children: "Sin valorizaciones registradas" }), _jsx("p", { className: "text-gray-600", children: "Las valorizaciones se generar\u00E1n autom\u00E1ticamente seg\u00FAn el cronograma" })] })) })] })] }))] })] }) }));
};
export default DetalleObra;
